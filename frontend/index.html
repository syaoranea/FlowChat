<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Meu Ref√∫gio</title>
  <link rel="stylesheet" href="styles.css">
</head>

<body>

  <div class="page">

    <div class="wrapper">

      <div class="border-outer"></div>

      <div class="container-blue">

        <div class="login-box">
<div class="login-content" id="login-content">
  <img src="./assets/logo.png" alt="Meu Ref√∫gio" class="logo">

  <p class="subtitle">acesse sua conta</p>

  <label>usu√°rio</label>
  <input type="email" id="email" placeholder="email@email.com">

  <label>senha</label>
  <input type="password" id="senha" placeholder="********">

  <button class="btn-primary" onclick="login()">
    Avan√ßar
  </button>

  <!-- üîπ NOVO: bot√£o de cadastro -->
  <button class="link" onclick="cadastrar()">
    Criar conta
  </button>

  <button class="link" onclick="mostrarEsqueciSenha()">
    Esqueci minha senha
  </button>

  <p id="erro-login" style="color:red; margin-top:12px; text-align: center;"></p>
</div>

</div>

        <div class="side-text">
          <h2>Que bom ter voc√™ aqui!</h2>
          <p>
            Entre com seus dados para acessar o FlowChat,
            um espa√ßo pensado para acolher voc√™.
          </p>
        </div>

      </div>
    </div>

  </div>
<script>
  const container = document.getElementById("login-content");

  function telaLogin() {
    container.innerHTML = `
      <img src="./assets/logo.png" class="logo">

      <p class="subtitle">acesse sua conta</p>

      <label>email</label>
      <input type="email" id="email" placeholder="email@email.com">

      <label>senha</label>
      <input type="password" id="senha" placeholder="********">

      <button class="btn-primary" onclick="login()">Avan√ßar</button>

      <button class="link" onclick="telaCadastro()">Criar conta</button>
      <button class="link" onclick="telaRecuperar()">Esqueci minha senha</button>

      <p id="erro-login" style="color:red; margin-top:12px; text-align:center;"></p>
    `;
  }

  function telaCadastro() {
    container.innerHTML = `
      <img src="./assets/logo.png" class="logo">

      <p class="subtitle">criar conta</p>

      <label>email</label>
      <input type="email" id="email" placeholder="email@email.com">

      <label>senha</label>
      <input type="password" id="senha" placeholder="m√≠nimo 6 caracteres">

      <button class="btn-primary" onclick="cadastrar()">Cadastrar</button>

      <button class="link" onclick="telaLogin()">J√° tenho conta</button>

      <p id="erro-login" style="color:red; margin-top:12px; text-align:center;"></p>
    `;
  }

  function telaRecuperar() {
    container.innerHTML = `
      <img src="./assets/logo.png" class="logo">

      <p class="subtitle">recuperar acesso</p>

      <label>email</label>
      <input type="email" id="email" placeholder="email@email.com">

      <button class="btn-primary" onclick="recuperarSenha()">Enviar link</button>

      <button class="link" onclick="telaLogin()">Voltar</button>

      <p id="erro-login" style="color:red; margin-top:12px; text-align:center;"></p>
    `;
  }

  // inicia na tela de login
  telaLogin();
</script>

<!-- FIREBASE -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
  import {
    getAuth,
    signInWithEmailAndPassword,
    createUserWithEmailAndPassword,
    sendPasswordResetEmail
  } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";

  const firebaseConfig = {
    apiKey: "AIzaSyD7lf9vlH-nL-m-8mUgD08SCbPqLTthftQ",
    authDomain: "flowchat-1a9ea.firebaseapp.com",
    projectId: "flowchat-1a9ea",
    storageBucket: "flowchat-1a9ea.firebasestorage.app",
    messagingSenderId: "640169787612",
    appId: "1:640169787612:web:fc1ad829473a61fd043419"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);

  // üîê LOGIN
  window.login = async function () {
    const email = document.getElementById("email").value;
    const senha = document.getElementById("senha").value;
    const erro = document.getElementById("erro-login");

    try {
      await signInWithEmailAndPassword(auth, email, senha);
      window.location.href = "admin.html";
    } catch (e) {
      erro.innerText = "Email ou senha inv√°lidos";
    }
  };

  // üÜï CADASTRO
  window.cadastrar = async function () {
    const email = document.getElementById("email").value;
    const senha = document.getElementById("senha").value;
    const erro = document.getElementById("erro-login");

    if (senha.length < 6) {
      erro.innerText = "A senha precisa ter no m√≠nimo 6 caracteres";
      return;
    }

    try {
      await createUserWithEmailAndPassword(auth, email, senha);
      window.location.href = "admin.html";
    } catch (e) {
      erro.innerText = "Erro ao criar conta. Email j√° existe?";
    }
  };

  // üîÅ RECUPERAR SENHA
  window.recuperarSenha = async function () {
    const email = document.getElementById("email").value;
    const erro = document.getElementById("erro-login");

    try {
      await sendPasswordResetEmail(auth, email);
      erro.style.color = "green";
      erro.innerText = "Email de recupera√ß√£o enviado ‚úÖ";
    } catch (e) {
      erro.innerText = "Erro ao enviar email";
    }
  };
</script>



</body>
</html>
